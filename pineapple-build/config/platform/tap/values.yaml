#@ load("@ytt:data", "data")
apiVersion: v1
kind: Secret
metadata:
  name: tap-tap-install-values
  namespace: tap-install
  annotations:
    kapp.k14s.io/change-group: "tap-install-values"
type: Opaque
stringData:
  #@yaml/text-templated-strings
  tap-values.yml: |
    ---
    profile: build

    ceip_policy_disclosed: true

    buildservice:
      kp_default_repository: (@= data.values.registry_credentials.server @)/(@= data.values.registry_credentials.username @)/build-service
      kp_default_repository_secret:
        name: registry-secret
        namespace: tap-install  
      exclude_dependencies: true

    supply_chain: testing

    ootb_supply_chain_testing:
      cluster_builder: base-jammy
      registry:
        server: (@= data.values.registry_credentials.server @)
        repository: (@= data.values.registry_credentials.username @)/supply-chain
      gitops:
        ssh_secret: ""
        user_name: making-bot
        user_email: makingx+bot@gmail.com
        commit_message: Bump    
        commit_strategy: pull_request
        server_address: https://github.com
        repository_owner: categolj
        repository_name: tap-gitops 
        pull_request:
          server_kind: github
          commit_branch: ""
          pull_request_title: "ready for review"
          pull_request_body: "generated by ootb_supply_chain_testing"  

    scanning:
      metadataStore:
        url: "" # Disable embedded integration since it's deprecated

    package_overlays:
    - name: tap-telemetry
      secrets:
      - name: tap-telemetry-remove
    - name: ootb-templates
      secrets:
      - name: ootb-templates-send-to-channel-slack

    excluded_packages:
    - grype.scanning.apps.tanzu.vmware.com
    - contour.tanzu.vmware.com